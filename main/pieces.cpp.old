/*
===============================================================================
  pieces.cpp — Définition des pièces Tetris (AKA Edition)
===============================================================================
*/

#include "pieces.h"
#include "graphics.h"   

// -----------------------------------------------------------------------------
//  Définition brute des 7 pièces (I, O, T, S, Z, J, L)
//  Format : PIECES[piece][rotation][y][x]
// -----------------------------------------------------------------------------
static const int PIECES[7][4][4][4] =
{
    // -------------------------------------------------------------------------
    // I
    // -------------------------------------------------------------------------
    {
        { {0,0,0,0},
          {1,1,1,1},
          {0,0,0,0},
          {0,0,0,0} },

        { {0,0,1,0},
          {0,0,1,0},
          {0,0,1,0},
          {0,0,1,0} },

        { {0,0,0,0},
          {1,1,1,1},
          {0,0,0,0},
          {0,0,0,0} },

        { {0,1,0,0},
          {0,1,0,0},
          {0,1,0,0},
          {0,1,0,0} }
    },

    // -------------------------------------------------------------------------
    // O
    // -------------------------------------------------------------------------
    {
        { {0,0,0,0},
          {0,1,1,0},
          {0,1,1,0},
          {0,0,0,0} },

        { {0,0,0,0},
          {0,1,1,0},
          {0,1,1,0},
          {0,0,0,0} },

        { {0,0,0,0},
          {0,1,1,0},
          {0,1,1,0},
          {0,0,0,0} },

        { {0,0,0,0},
          {0,1,1,0},
          {0,1,1,0},
          {0,0,0,0} }
    },

    // -------------------------------------------------------------------------
    // T
    // -------------------------------------------------------------------------
    {
        { {0,0,0,0},
          {1,1,1,0},
          {0,1,0,0},
          {0,0,0,0} },

        { {0,1,0,0},
          {1,1,0,0},
          {0,1,0,0},
          {0,0,0,0} },

        { {0,1,0,0},
          {1,1,1,0},
          {0,0,0,0},
          {0,0,0,0} },

        { {0,1,0,0},
          {0,1,1,0},
          {0,1,0,0},
          {0,0,0,0} }
    },

    // -------------------------------------------------------------------------
    // S
    // -------------------------------------------------------------------------
    {
        { {0,0,0,0},
          {0,1,1,0},
          {1,1,0,0},
          {0,0,0,0} },

        { {1,0,0,0},
          {1,1,0,0},
          {0,1,0,0},
          {0,0,0,0} },

        { {0,0,0,0},
          {0,1,1,0},
          {1,1,0,0},
          {0,0,0,0} },

        { {1,0,0,0},
          {1,1,0,0},
          {0,1,0,0},
          {0,0,0,0} }
    },

    // -------------------------------------------------------------------------
    // Z
    // -------------------------------------------------------------------------
    {
        { {0,0,0,0},
          {1,1,0,0},
          {0,1,1,0},
          {0,0,0,0} },

        { {0,1,0,0},
          {1,1,0,0},
          {1,0,0,0},
          {0,0,0,0} },

        { {0,0,0,0},
          {1,1,0,0},
          {0,1,1,0},
          {0,0,0,0} },

        { {0,1,0,0},
          {1,1,0,0},
          {1,0,0,0},
          {0,0,0,0} }
    },

    // -------------------------------------------------------------------------
    // J
    // -------------------------------------------------------------------------
    {
        { {0,0,0,0},
          {1,1,1,0},
          {0,0,1,0},
          {0,0,0,0} },

        { {0,1,0,0},
          {0,1,0,0},
          {1,1,0,0},
          {0,0,0,0} },

        { {1,0,0,0},
          {1,1,1,0},
          {0,0,0,0},
          {0,0,0,0} },

        { {0,1,1,0},
          {0,1,0,0},
          {0,1,0,0},
          {0,0,0,0} }
    },

    // -------------------------------------------------------------------------
    // L
    // -------------------------------------------------------------------------
    {
        { {0,0,0,0},
          {1,1,1,0},
          {1,0,0,0},
          {0,0,0,0} },

        { {1,1,0,0},
          {0,1,0,0},
          {0,1,0,0},
          {0,0,0,0} },

        { {0,0,1,0},
          {1,1,1,0},
          {0,0,0,0},
          {0,0,0,0} },

        { {0,1,0,0},
          {0,1,0,0},
          {0,1,1,0},
          {0,0,0,0} }
    }
};

// -----------------------------------------------------------------------------
//  Accès à une cellule de pièce
// -----------------------------------------------------------------------------
int piece_at(int piece, int rot, int y, int x)
{
    return PIECES[piece][rot][y][x];
}

// -----------------------------------------------------------------------------
//  Couleurs des pièces (1..7)
// -----------------------------------------------------------------------------

uint16_t piece_color(int id)
{
    static constexpr uint16_t COLORS[8] = {
        COLOR_BLACK,      // 0 = vide
        COLOR_LIGHTBLUE,  // 1 = I
        COLOR_YELLOW,     // 2 = O
        COLOR_PURPLE,     // 3 = T
        COLOR_LIGHTGREEN, // 4 = S
        COLOR_RED,        // 5 = Z
        COLOR_BLUE,       // 6 = J
        COLOR_ORANGE      // 7 = L
    };

    return COLORS[id];
}

